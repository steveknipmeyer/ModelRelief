<!DOCTYPE html>
<html>
<head>
    <title>Commit Notes</title>
</head>
<body>

    <h5 id="commit-notes">Commit Notes</h5>
<p>Some Markdown text with <span style="color:blue">some <em>blue</em> text</p>
<h5 id="technical-education">Technical Education</h5>
<ul>
<li>Manning AspNet Core book.</li>
<li>Manning Dependency Injection book.</li>
</ul>
<h5 id="lambda">Lambda</h5>
<pre><code>Python programs must be invoked by py &lt;program&gt;. This is not necessary on Vector.
</code></pre>
<h3 id="tasks">Tasks</h3>
<h4 id="short-term">Short Term</h4>
<h4 id="front-end">Front End</h4>
<pre><code>Is the interface IGenerateFile needed?
</code></pre>
<table>
<thead>
<tr>
<th>Original Type</th>
<th>NewType</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReliefSettings</td>
<td>MeshTransform</td>
<td></td>
</tr>
<tr>
<td>DepthBuffer</td>
<td>RawDepthBuffer</td>
<td>DtoDepthBuffer implemented</td>
</tr>
<tr>
<td>Camera</td>
<td></td>
<td>DtoCamera implemented</td>
</tr>
<tr>
<td>Relief</td>
<td></td>
<td>?</td>
</tr>
</tbody>
</table>
<pre><code>Create a ModelRelief JavaScript API library.
    Publish POCO models to JavaScript?
    Create a utility URL composer.

File Transfer
    Use jQuery!
    Wait for file POST to complete before initiating the second metadata POST.

async/await
    Refactor Export OBJ.

Accessing Model From JavaScript
    https://stackoverflow.com/questions/16361364/accessing-mvcs-model-property-from-javascript

Webpack

Some Views are identical. Should they use a shared ViewComponent?
    Create, Edit
    Details, Delete
</code></pre>
<h5 id="mesh-generation-prototype">Mesh Generation Prototype</h5>
<pre><code>Current
    Client
        Create DepthBuffer
        DepthBufferFactory -&gt; Create Mesh
        Post DepthBuffer
</code></pre>
<table>
<thead>
<tr>
<th>Client</th>
<th>Server</th>
</tr>
</thead>
<tbody>
<tr>
<td>Create DepthBuffer in-memory</td>
<td></td>
</tr>
<tr>
<td>Post DepthBuffer</td>
<td></td>
</tr>
<tr>
<td>Post DepthBuffer/id/file</td>
<td></td>
</tr>
<tr>
<td>Post MeshTransform</td>
<td></td>
</tr>
<tr>
<td>Post Mesh = Mesh (DepthBuffer, MeshTransform)</td>
<td></td>
</tr>
<tr>
<td>Patch Mesh.FileIsSynchronized = true</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Solver &lt;Mesh.json&gt; filename</td>
</tr>
<tr>
<td></td>
<td>Post Mesh/id/file (raw file)</td>
</tr>
<tr>
<td>Get Mesh/id/file</td>
<td></td>
</tr>
<tr>
<td>Construct Mesh from raw file</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="critical-issues">Critical Issues</h5>
<span style="color:red">
Replace DateTime with a type that has more resolution.
</span><br></br>
<h6 id="improve-rollback-handling-in-integration-tests">Improve rollback handling in integration tests.</h6>
<pre><code>try/catch/finally?
</code></pre>
<h6 id="fileoperationgenerate">FileOperationGenerate</h6>
<pre><code>Validate the required properties are present.
    Implement a FluentValidation validator.
    Throw a validation exception if the required properties are not set.
</code></pre>
<h6 id="codeanalysis">CodeAnalysis</h6>
<pre><code>NET Core?
</code></pre>
<h6 id="refactoring-suggestion-font-size">Refactoring Suggestion Font Size</h6>
<h6 id="replace-console-output-with-logger-operations">Replace Console output with Logger operations.</h6>
<pre><code>Add color support for logging.
</code></pre>
<h6 id="should-filetimestamp-be-exposed">Should FileTimeStamp be exposed?</h6>
<pre><code>Should the assignment of FileSynchronized be deferred until the request has completed?
FileStamp could potentially serve as the &quot;complete&quot; flag for a long-running request. 
</code></pre>
<h4 id="python-tasks">Python Tasks</h4>
<h6 id="virtual-evironment">Virtual Evironment</h6>
<pre><code>Create a virtual environment that is published with the web application.
This will allow the Python path and runtime environment to be precisely defined.
</code></pre>
<h6 id="queues">Queues</h6>
<pre><code class="language-&lt;language&gt;">FileRequest places a message in a work queue.  
    FileIsSynchronized is reset to false.  
    A status code of 202 is returned to the client who can poll the value of FileIsSynchronized.
        Consider returning an endpoint that can be used for querying the result of the task.
        meshes/id/file/task
A worker process removes the request from the queue.
    An external job is dispatched which returns some kind of notification when complete.  
    When the external job completes, the worker process sets FileIsSynchronized = true.
    Question: How does a worker process access the database?
    

</code></pre>
<p><a href="https://stackoverflow.com/questions/11779143/how-do-i-run-a-python-script-from-c">https://stackoverflow.com/questions/11779143/how-do-i-run-a-python-script-from-c</a><br />
<a href="https://medium.com/@dpursanov/running-python-script-from-c-and-working-with-the-results-843e68d230e5">https://medium.com/@dpursanov/running-python-script-from-c-and-working-with-the-results-843e68d230e5</a></p>
<p><a href="https://stackoverflow.com/questions/10788982/is-there-any-async-equivalent-of-process-start">https://stackoverflow.com/questions/10788982/is-there-any-async-equivalent-of-process-start</a>
<a href="https://github.com/jamesmanning/RunProcessAsTask">https://github.com/jamesmanning/RunProcessAsTask</a></p>
<p>Long-running Requests:<br />
<a href="https://stackoverflow.com/questions/33009721/long-running-rest-api-with-queues">https://stackoverflow.com/questions/33009721/long-running-rest-api-with-queues</a></p>
<h6 id="files">Files</h6>
<pre><code>The name property for FileDomainModels is expected to include the extension.    
    API  and Ux validation is needed to ensure that the extension is always present.
        Can it be inferred from the Format?
How will the Format property be used for Models, DepthBuffers and Meshes?
    Is it necessary if the file type can be found through reflection?
How should the model name be held in the ModelViewer?
    The model.Name property is now 'Root' (THREE).
</code></pre>
<h6 id="review-and-organize-the-postman-tests">Review and organize the Postman tests.</h6>
<hr />
<h4 id="dependency-manager">Dependency Manager</h4>
<h5 id="dependency-handling">Dependency Handling</h5>
<p><strong>Modified</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> For GeneratedFileDomainModel root models, if FileIsSynchronized <changed> to true, schedule a FileOperation.Generation.</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> For FileDomainModel root models, if Name <changed>, schedule a FileOperation.Rename.</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> For all GeneratedFileDomainModel dependents, set FileIsSynchronized = false.</li>
</ul>
<p><strong>Deleted</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> For all GeneratedFileDomainModel dependents, set FileIsSynchronized = false.</li>
</ul>
<p><strong>Added</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> For all GeneratedFileDomainModel root models, if FileIsSynchronized = true, schedule a file generation if the dependents are resolved.</li>
</ul>
<pre><code>GeneratedFileDomainModel Dependencies
                                        Metadata    FileTimeStamp
    DepthBuffer
        Model                                       X
        Camera                          X
    Mesh
        DepthBuffer                                 X
        MeshTransform                   X

</code></pre>
<h6 id="depthbuffers-should-have-an-optional-dependency-on-a-model3d">DepthBuffers should have an optional dependency on a Model3d.</h6>
<pre><code>If the Model3d relationship is present, the dependency exists.  
Otherwise, the DepthBuffer exists independently, probably due to an explicit upload of a file created in another application.  
The DependencyManager invalidates DependentFiles only if a dependency changed. So, an existing DepthBuffer with (FileSynchronized = true) would not be impacted.
</code></pre>
<h6 id="property-change-handlers">Property Change Handlers</h6>
<p><a href="https://msdn.microsoft.com/magazine/mt694083">https://msdn.microsoft.com/magazine/mt694083</a><br />
<a href="https://msdn.microsoft.com/en-us/magazine/mt767693.aspx">https://msdn.microsoft.com/en-us/magazine/mt767693.aspx</a></p>
<h6 id="how-can-properties-be-excluded-e.g.attribute-from-entity-processing">How can properties be excluded (e.g. Attribute) from entity processing?</h6>
<h4 id="architecture">Architecture</h4>
<pre><code>How should byte-ordering (BigEndian, LittleEndian) be handled?
    Are some devices (e.g. phones) BigEndian?
</code></pre>
<h4 id="api-design">API Design</h4>
<pre><code>UX Requests
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Browser forms support only GET or POST.
                                                                                                                                                                                                                                                                                                                                                                     
View            Operation               Note            HTTP            Endpoint                                Internal Request        Return
---------       ---------               ------------    ------------    ---------------------                   -----------------       -------------------------
Index           read (collection)                       GET             /api/v1/resource                        GetList                 View; paged collection
Details         read (single)                           GET             /api/v1/resource/details/id             GetSingle               View; JSON object
Create          create                                  POST            /api/v1/resource                        PostAdd                 View; JSON object
Edit            update                                  POST            /api/v1/resource/edit/id                Put                     View; JSON object
Delete          delete                                  POST            /api/v1/resource/deleteconfirmed/id     Delete                  Index


API Requests
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Format          Operation               Note            HTTP           Endpoint                                 Internal Request        Return
---------       ---------               ------------    ------------   ---------------------                    -----------------      -------------------------
JSON            read (collection)                       GET            /api/v1/resource/id                      GetList                 OK; JSON collection
JSON            read (single)                           GET            /api/v1/resource/id                      GetSingle               OK; JSON object
JSON            create                                  POST           /api/v1/resource                         Post                    Created; new id returned and default metadata       
JSON            update (full)                           PUT            /api/v1/resource/id                      Put                     OK; JSON object
JSON            update (partial)                        PATCH          /api/v1/resource/id                      Patch                   OK; JSON object
JSON            update (partial)                        PUT            /api/v1/resource/id/patch                Patch                   OK; JSON object
JSON            delete                                  DELETE         /api/v1/resource/id                      Delete                  OK

binary          read (single)                           GET            /api/v1/resource/id/file                 GetFile                 OK; octet-stream
binary          create                  Mesh disallowed POST           /api/v1/resource/id/file                 PostFile                Created; new id returned and default metadata       
binary          update (full)                           PUT            /api/v1/resource/id/file                 PutFile                 OK
binary          update (partial)        no endpoint   
binary          delete                                  DELETE         /api/v1/resource/id/File                 DeleteFile              OK
</code></pre>
<p>Add authentication support!</p>
<p>The Project is populating the object graph too deeply.</p>
<h6 id="enhancements">Enhancements</h6>
<pre><code>Express relationships as &quot;href&quot; properties to absolute URLs.
Provide &quot;reference expansion&quot; to allow references to be expanded into the principal object.
</code></pre>
<h6 id="stormpath-pattern">Stormpath Pattern</h6>
<pre><code>Rich error message:
    Status Code         HttpStatusCode                   
    Code                ApiErrorCode
    Message             Errors[]
    DeveloperMessage    DeveloperMessage   
    API Reference       ApiReference
</code></pre>
<h4 id="logging">Logging</h4>
<pre><code>Limit the size of the log file.

Log ApiErrorResult?

XUnit TestRunner Output
https://github.com/marhoily/serilog-sinks-xunittestoutput

Review the ILogger interface. How should this work with a Controller?
</code></pre>
<pre><code class="language-c#">    namespace Microsoft.Extensions.Logging
    {
        //
        // Summary:
        //     A generic interface for logging where the category name is derived from the specified
        //     TCategoryName type name. Generally used to enable activation of a named Microsoft.Extensions.Logging.ILogger
        //     from dependency injection.
        //
        // Type parameters:
        //   TCategoryName:
        //     The type who's name is used for the logger category name.
        public interface ILogger&lt;out TCategoryName&gt; : ILogger
        {
        }
    }

</code></pre>
<h4 id="storagemanager">StorageManager</h4>
<p>An ApplicationUser could have a storage folder property that is used by the StorageManager to define the default location.</p>
<h4 id="domainmodel">DomainModel</h4>
<h4 id="filedomainmodel">FileDomainModel</h4>
<pre><code>Casting from DomainModel to FileDomainModel can only be done when access to the specific type is not needed.
PostFile
    var fileName = Path.Combine(storageManager.DefaultModelStorageFolder(domainModel), domainModel.Name);
    The resolution of a storage location depends on looking up the TEntity.Name as a resource.
</code></pre>
<h4 id="exception-handling">Exception handling</h4>
<pre><code>The ApiValidationResult exposes too much about internals in the developer message (RequestType).

How should database exceptions, such as those violating Domain DataAnnotation rules, be handled?
https://andrewlock.net/using-cancellationtokens-in-asp-net-core-mvc-controllers/
Concurrency exceptions?

SqliteException: SQLite Error 5: 'database is locked'.
    PostFileRequestHandler : DbContext.SaveChanges();

Throwing policy.
    https://stackoverflow.com/questions/2999298/difference-between-throw-and-throw-new-exception        
</code></pre>
<h4 id="testing">Testing</h4>
<pre><code>xUnit Async
    https://github.com/xunit/xunit/issues/1066

Support database authentication.

Integration Tests
    If all integration and unit tests are non-destructive, is it necessary to refresh the Test database from the Baseline?
        This does not work with SQLServer as it seems to maintain an exclusive file lock during DbInitializer execution.

    How can XUnit be used to test all properties of a resource?
        Iterate through the property list of a Domain model.

    Ux Endpoints                    
        Data must be form-encoded not JSON?
        The [ValidateAntiForgeryToken] attribute leads to an exception.

    Split Api and Ux into separate assemblies?
        Can the ServerFixture be in a separate assembly?

Unit Tests                
    API Testing Mocks
        How can RouteNames.ApiDocumentation be registered as a route?
        Schema
        Host
        Port
</code></pre>
<h4 id="mediator">Mediator</h4>
<pre><code>Mediator Pipeline
    Should there be top-level logging and exception handling in a pipeline wrapper?
    https://codeopinion.com/fat-controller-cqrs-diet-command-pipeline/
</code></pre>
<h4 id="opinionated-api">Opinionated API</h4>
<p><a href="https://schneids.net/never-resting-restful-api-best-practices-using-asp-net-web-api/">https://schneids.net/never-resting-restful-api-best-practices-using-asp-net-web-api/</a></p>
<pre><code>OAPI Design
    Benefits
        Paging
        PUT (partial property list) support
        GET populates related entities (ProjectTo)

    abstract ApiController
            HandleRequestAsync
        abstract RestController
            HttpGet
            HttpPost
            HttpPut
            HttpDelete
            &lt;Model&gt;Controller
                overrides
                extensions
                    Viewer

    abstract ValidatedHandler
        &lt;Request&gt;Handler

    abstract RequestValidator
        &lt;Model&gt;&lt;Request&gt;Validator

    Pipeline
        Custom authentication middleware (Test)
            DbContextTransactionFilter.OnActionExecutionAsync
                begin transaction
                    Validators (Model-binding before action method)
                        RestController HTTP Action
                            ApiController.HandleAsyncRequest
                                var response = await Mediator.Send(request);
                                    ValidatatedHandler.Handle
                                        RequestHandler.Handle
                end transaction
</code></pre>
<h4 id="autofac">Autofac</h4>
<pre><code>ASP.NET Core
https://autofac.readthedocs.io/en/latest/integration/aspnetcore.html

Example
https://github.com/autofac/Examples/tree/master/src/AspNetCoreExample
</code></pre>
<h4 id="automapper">AutoMapper</h4>
<pre><code>The AutoMapper.QueryableExtensions ProjectTo will populate an object graph when used with a query. 
Otherwise, navigation properties will be null.
    var result = await DbContext.Set&lt;TEntity&gt;()
            .ProjectTo&lt;TGetModel&gt;(Mapper.ConfigurationProvider)
            .SingleOrDefaultAsync(m =&gt; m.Id == message.Id);

Getting along with AutoMapper and Autofac
https://kevsoft.net/2015/09/14/getting-along-with-automapper-and-autofac.html
</code></pre>
<h4 id="fluent-validation">Fluent Validation</h4>
<pre><code>https://github.com/JeremySkinner/FluentValidation
</code></pre>
<h4 id="rest-api-best-practices">REST API Best Practices</h4>
<pre><code>e-Book on API Design

Design Guidelines
    General
        https://blog.octo.com/en/design-a-rest-api/
        https://blog.octo.com/wp-content/uploads/2014/12/OCTO-Refcard_API_Design_EN_3.0.pdf
     Lowercase
        https://stackoverflow.com/questions/37423468/lowercase-urls-in-net-core-rc2
    Images
        https://stackoverflow.com/questions/33279153/rest-api-file-ie-images-processing-best-practices
    Documentation
        https://github.com/domaindrivendev/Swashbuckle.AspNetCore

    PUT, POST, PATCH
        https://stackoverflow.com/questions/630453/put-vs-post-in-rest
        https://stackoverflow.com/questions/28459418/rest-api-put-vs-patch-with-real-life-examples
        http://www.eq8.eu/blogs/36-patch-vs-put-and-the-patch-json-syntax-war

        PUT : complete
            The HTTP RFC specifies that PUT must take a full new resource representation as the request entity. 
            This means that if for example only certain attributes are provided, those should be remove (i.e. set to null).
        PATCH : partial
</code></pre>
<h4 id="file-transfers">File Transfers</h4>
<pre><code>    JavaScript
        These solutions are for saving files on the client (not server) side.
            https://github.com/eligrey/FileSaver.js/
            https://github.com/jimmywarting/StreamSaver.js
</code></pre>
<h4 id="image-processing">Image processing</h4>
<pre><code>Image File Creation
    ImageSharp
    Create a 16 bit PNG from the depth data.

Images in ASPNET
    https://github.com/SixLabors/ImageSharp
    https://blogs.msdn.microsoft.com/dotnet/2017/01/19/net-core-image-processing/
    https://andrewlock.net/using-imagesharp-to-resize-images-in-asp-net-core-a-comparison-with-corecompat-system-drawing/
</code></pre>
<h4 id="mvc">MVC</h4>
<pre><code>Viewer.cshtml
    Models
        3D Model
        DepthBuffer (created by View settings)
        Mesh (created by mesh generation)

    Views
        ComposerView

        ModelView
            ModelViewer
                ModelViewerControls
        MeshView
            MeshViewer
                MeshViewerControls

    Controllers
        ComposerController
        (ModelController)
        (MeshController)
</code></pre>
<h4 id="viewer">Viewer</h4>
<pre><code>Progress Indicator
OrbitControls versus Trackball
Add MaterialLoader.

Create a set of sample materials such as wood, glass, plaster, etc.

Camera
    Why does the View change slightly after the 2nd Fit View?
        This happens only if the view has been &lt;panned&gt;.
</code></pre>
<h4 id="optimization">Optimization</h4>
<pre><code>Why is MeshValidator called several time during a Put request?

Optimize BoundingBox procesing.

Profiling
    Install additional IIS components?

Memory management!
    https://blog.sessionstack.com/how-javascript-works-memory-management-how-to-handle-4-common-memory-leaks-3f28b94cfbec
</code></pre>
<h4 id="aspnet-core">ASPNET Core</h4>
<h4 id="vscode-debugging-workflows">VSCode Debugging Workflows</h4>
<pre><code>Command Line
    FE: Chrome   BE: VSCode  TypeScript: automatic  Reload: automatic
        dotnet run
        gulp serve (automatic TypeScript/reload)
        VSCode Profile: .NET Core Attach
            Edit launch.json to set processId!

VSCode Profile: .Net Core With Browser
    FE: VSCode   BE: VSCode  TypeScript: DNW  Reload: DNW

VSCode Profile: .Net Core Launch (web)
    FE: Chrome   BE: VSCode  TypeScript: DNW  Reload: DNW

VSCode Profile: .NET Core Attach
    Edit launch.json to set processId!
    https://github.com/OmniSharp/omnisharp-vscode/issues/897
    An error happens running the command below. It should open a UI to pick the process.
        D:\Users\Steve Knipmeyer\Documents\GitHub\ModelRelief\ModelRelief&gt;wmic process get Name,ProcessId,CommandLine
        Invalid XML content.

VSCode Resources
    https://stackoverflow.com/questions/43628397/debug-typescript-in-vscode-with-asp-net-core
    https://code.visualstudio.com/blogs/2016/02/23/introducing-chrome-debugger-for-vs-code
</code></pre>
<h4 id="depth-buffer-notes">Depth Buffer Notes</h4>
<pre><code>Experiment with precision setting in THREE.WebGLRenderer.

Precision is substantially improved by moving the Near plane as close to the model as possible.
    Pulling in the Far plane does not seem to improve the precision.

The range of the depth buffer is based on the distance between the Near and Far planes. 
    If the Near and Far planes bound the model, the range will be [0.1].
</code></pre>
<h4 id="database-design">Database Design</h4>
<pre><code>Issues
    Analyze the correct behavior of OnDelete.
        Some dependent entities (e.g. Mesh) may potentially be deleted if the parent (e.g. DepthBuffer) is deleted.
    Referential Integrity!
    Should &lt;all&gt; entities have a direct relationship to Project or only &quot;principal&quot; entities.
        For example a Mesh is directly related to a Project but that relationship is also inditectly captured by Mesh-&gt;DepthBuffer-&gt;Model-&gt;Project.
    Should principal entities have a collection property that holds all children? These &lt;can&gt; be found with a query.
        For example:
            Project
                Cameras
                DepthBuffers
                Meshes
                Models
                MeshTransforms

https://stackoverflow.com/questions/33197402/link-asp-net-identity-users-to-user-detail-table

Why are navigation properties virtual?
    https://stackoverflow.com/questions/25715474/why-navigation-properties-are-virtual-by-default-in-ef

How can the database be backed up?
    Can it be relocated to another location?

Phase II       
     Materials
        DomainModel

    Model3d
        Material
        LightingSetup

    LightingSetup
        DomainModel

    LightingSetupLights (join table)
        DomainModel
        Lighting ID
        Light ID
        A supporting join table is needed to connect a lighting configuration with the individual lights.

SQL Server Studio
    Connnect to a locadb from Studio
    http://nikgupta.net/2015/12/10/connect-localdb-from-management-studio/

    C:\Program Files\Microsoft SQL Server\130\Tools\Binn
        λ SqlLocalDB.exe info MSSQLLOCALDB
        Name:               MSSQLLocalDB
        Version:            13.1.4001.0
        Shared name:
        Owner:              VECTOR\Steve Knipmeyer
        Auto-create:        Yes
        State:              Running
        Last start time:    9/19/2017 6:57:25 AM
        Instance pipe name: np:\\.\pipe\LOCALDB#9A6B632F\tsql\query
</code></pre>
<h4 id="database">Database</h4>
<pre><code>Use UUID not sequential integer keys in database. This will scale better.

SQLite
    Multi-user Access
        Cookies are used so tests must be done from an external computer.
    64 bit support
</code></pre>
<h4 id="git">Git</h4>
<pre><code>TBD
</code></pre>
<h4 id="typescript">TypeScript</h4>
<pre><code>How can a subclass call the property (method) of a super class?
    https://github.com/Microsoft/TypeScript/issues/4465
    ModelViewer extends Viewer
        set model (model : THREE.Object) {
            super.model(model);     // not valid
        }            

TypeScript Typings management
    Where is the Visual Studio instance of node.s installed?
        &quot;C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\Extensions\Microsoft\Web Tools\External&quot;
        Where are the Visual Studio (automatic) npm typings?
            C:\Users\Steve Knipmeyer\AppData\Local\Microsoft\TypeScript\node_modules\@types
            https://stackoverflow.com/questions/42663010/typescript-in-visual-studio-2017-automatic-definition-inclusion-causes-duplicat
            https://blogs.msdn.microsoft.com/visualstudio/2016/11/28/more-productive-javascript-in-visual-studio-2017-rc/
                (Note: This feature is disabled by default if using a tsconfig.json configuration file

    var uint8Array = new Uint8Array((&lt;any&gt;fileDataObj.target).result);
        EventTarget does not contain a member result.
        https://github.com/Microsoft/TSJS-lib-generator/pull/207
        https://github.com/Microsoft/TypeScript/issues/299
</code></pre>
<h4 id="html">HTML</h4>
<pre><code>What is the correct use of user-scalable-no? Should it appear only on the Model Viewer page and not be included in the _Layout.cshtml?
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;

What is the asp-fallback-test for jquery-validation-unobtrusive?

Why does jQuery need to be loaded before require.js (module mismatch error)?
    https://stackoverflow.com/questions/4535926/how-do-i-use-requirejs-and-jquery-together
</code></pre>
<h4 id="modules">Modules</h4>
<pre><code>http://davidbcalhoun.com/2014/what-is-amd-commonjs-and-umd/

What is the recommended way to split a module over multiple files?
    Using a d.ts file and 'export as namespace' works but it led to issues loading MR in require.js. 
        modelrelief.d.ts
            export as namespace MR

            export * from &quot;fileA&quot;
            export * from &quot;fileB&quot;

        MR is composed of multiple disk files. How is that handled with AMD modules in require.js?
            When TypeScript creates the AMD output, the module name is the disk file. There is no definition of MR as an aggregate.
            Is there a require.config that maps a module name to multiple separate modules?
                MR -&gt; fileA,fileB
        
        Can a module name have a period such as MR.Graphics?
            import * as MR.Graphics from &quot;Graphics&quot; led to an error.

        Can multiple modules be imported into the same alias? This construct is not valid.
            import * as MR from&quot;Graphics&quot;
            import * as MR from&quot;Views&quot;
</code></pre>
<h4 id="three.js-notes">THREE.js Notes</h4>
<pre><code>Object clone &lt;only&gt; copies Object3d properties.

Object matrices are updated only during the render loop. The property matrixAutoUpdate enables this update but not update the matrix when dependent properties are changed.
    Use Object3d.updateMatrixWorld(true) to force an update.

A Group can belong to only one Scene.
    let sceneA   = new THREE.Scene();
    let theGroup = new THREE.Group();
    sceneA.add(theGroup);

    let sceneB = new THREE.Scene();
    sceneB.add(theGroup);
</code></pre>
<h4 id="technical-notes">Technical Notes</h4>
<pre><code>Base64 encoding for HttpRequest.
    https://github.com/beatgammit/base64-js
    https://github.com/hughsk/tab64

How is byte ordering (little/big endian) handled in HTTP requests?
    http://calculist.org/blog/2012/04/25/the-little-endian-web/

MultiPart Form
    https://stackoverflow.com/questions/3938569/how-do-i-upload-a-file-with-metadata-using-a-rest-web-service

    https://stackoverflow.com/questions/4083702/posting-a-file-and-associated-data-to-a-restful-webservice-preferably-as-json
    https://stackoverflow.com/questions/30655582/uploading-files-and-json-data-in-the-same-request-with-jquery-ajax

    https://stackoverflow.com/questions/43674504/multipart-form-data-file-upload-in-asp-net-core-web-api

MIMETypes
    Similarly, for binary documents without specific or known subtype, application/octet-stream should be used.
</code></pre>
<h4 id="licenses">Licenses</h4>
<pre><code>THREE.js        MIT
Serilog         Apache https://www.apache.org/licenses/LICENSE-2.0
Autofac         MIT
MediatR         Apache https://github.com/jbogard/MediatR/blob/master/LICENSE
FeatureFolders  MIT https://raw.githubusercontent.com/OdeToCode/AddFeatureFolders/master/LICENSE

OpinionatedApiController : Spencer Schneidenbach
ContosoCore              : Jimmy Bogard
</code></pre>
<h4 id="visual-studio">Visual Studio</h4>
<pre><code>Performance
    https://developercommunity.visualstudio.com/content/problem/43364/visual-studio-2017-increadibly-slow-and-laggy.html
Private Hive
https://stackoverflow.com/questions/42916299/access-visual-studio-2017s-private-registry-hive
</code></pre>
<h4 id="identity">Identity</h4>
<pre><code>https://andrewlock.net/introduction-to-authentication-with-asp-net-core/
</code></pre>
<h4 id="asp.net-core-model-validation">ASP.NET Core Model Validation</h4>
<pre><code>https://github.com/JeremySkinner/FluentValidation/wiki/i.-ASP.NET-Core-integration
</code></pre>
<h5 id="best-practices">Best Practices</h5>
<pre><code>DataAnnotation rules also should be used for DTO.
    They &lt;complement&gt; FV. They (and any other registered validators) run after FV.
    They provide display formatting and other UX support.
The Domain models should also use DataAnnotation attributes. 
    Validation will be done when a model (created OUTSIDE) the UX is transacted with the database.
    This happens as a part of model-binding.
The DTO should expose only those properies which are editable!
    Missing properties in the View will override the target during mapping because they will have a default value.
</code></pre>
<hr />
<h6 id="client-side-validation">Client-side Validation</h6>
<pre><code>The View model (e.g. Dto.Mesh) determines the client-side validation rules.
    Any associated validators for this specific type will run.

DataAnnotation Attributes
    Property ON form: A client-side error will be displayed and the controller action will not be called.
    Property not present on form: Validation will be done in the server IF the model-bound action parameter contains a validation rule. 
        ModelState will contain errors when the controller action is called.

    N.B. ContosoUniversityCore uses server-side validation (in conjunction with site.js and HtmlHelperExtensions error handling). 
        Any DataAnnotation attributes on the DTO are ignored. No data-val attributes are added to the View.
            Is this because the jquery-validation-unobtrusive scripts are not include in the View page?
        If a DataAnnotation rule was violated (e.g. [Required]) and there was no FluentValidation (AbstractValidator rule), the property was not marked as invalid.
        * This seems odd because although the form did not contain the client-side validation attributes, why did MVC not validate the object on the incoming model-bound object?
            Is this due to the custom model-binding?
        However, if the Domain model contains DataAnnotation attributes these are processed when the model is transacted to the database.

    [StringLength(50, MinimumLength = 3)]
    public string Name { get; set; }

Aggregating Validation Rules
    If View model implements any of these interfaces then additional validation checks will be added the complete list of checks, adding additional results to ModelState.
        FluentValidation.AbstractValidator&lt;T&gt; : (runs first by default)
        DataAnnotation
        IValidatableObject 
    N.B. These are all used by a View if present! Each of these validations contribute rules (in the form of data-val attributes) that are used in the client-side processing.
</code></pre>
<h6 id="server-side-validation">Server-Side Validation</h6>
<pre><code>The controller action parameters (e.g. Create.Command) control the server-side validation rules.
    Any associated validators for this specific type will run.
    This happens during model-binding.

Model-binding maps the Request.Body, route data and query strings to the parameters of the controller action. 
    By default, MVC supports a limited number of formatters.

All validation providers can contribute rules to the validation.
    DataAnnotation Attribute
    IValidatable
    FluentValidation

ValidationActionFilter
    If an ActionFilter is registered, control passes there.
        The ActionFilter can check ModelState.Valid and then set the ActionExecutingContext.Result so the controller action is never called.

Finally, the controller action is invoked.
</code></pre>
<hr />
<pre><code>Can the request handlers share common validation code?
                            Entity Exists   StorageFolder   File Exists     Formatting
    GetSingle               X                                               X
    GetList                                                                 X

    Delete                  X               
        DeleteStorage                       X               X
    Put                     X                                               X
    Patch                   X                                               X
    GetFile                 X               X               X

    Post                                                                    X
    PostFile                                X                               X
</code></pre>
<h4 id="variance">Variance</h4>
<h6 id="invariance">Invariance</h6>
<pre><code>The types must match exactly.
</code></pre>
<h6 id="covariance-out-parameters-more-derived">Covariance (out parameters) : More Derived</h6>
<pre><code>public interface IEnumerable (out T)

A more derived type can be substituted.
The parameter can be returned because it satisfies the type because it is of type Base.
</code></pre>
<h6 id="contravariance-in-parameters-less-derived">Contravariance (in parameters) : Less Derived</h6>
<pre><code>public interface IComparer&lt;in T&gt;

A less derived type can be substituted.
When the method is called, the &lt;actual&gt; parameter passed to the method will be &lt;more derived&gt; so it will satisfy the type of the actual method that is invoked.
</code></pre>
<h4 id="tasks-1">Tasks</h4>
<pre><code>    // prevent async (no await) warning
    //https://stackoverflow.com/questions/44096253/await-task-completedtask-for-what
</code></pre>
<pre><code class="language-c#">        await Task.CompletedTask;
</code></pre>
<h4 id="contosouniversity-core">ContosoUniversity Core</h4>
<pre><code>Why is the project named &quot;Core&quot; when it has these dependencies? 
    AutoMapper.EF6
        EntityFramework 6.13

Why does Delete display the JSON ContentResult instead of the IndexView?
    The site.js file includes a jQuery call back on all form post submits.
    site.js provides client-side error validation.

How is the ContosoUniversityCore model binding used?
    public class EntityModelBinder : IModelBinder
    It binds a database &lt;model&gt; looked up from the incoming Id.
</code></pre>
<h4 id="cmder">Cmder</h4>
<pre><code>ModelReliefShell.bat is started through this batch file located in D:\Users\Steve Knipmeyer\Documents\Bin\cmder\config\profile.d:
    StartModelReliefShell.bat
        &quot;D:\Users\Steve Knipmeyer\Documents\GitHub\ModelRelief\ModelRelief\Tools\ModelReliefShell.bat&quot;
</code></pre>
<h4 id="new-computer-setup">New Computer Setup</h4>
<pre><code>The Test files are not restored from Git because some (e.g. .obj) are excluded by .gitignore.
gulp must be installed globally.
    npm install --global gulp-cli
Unit tests require running Baseline.py after running ModelRelief.Test to create the initial Test database.
node must be installed.
</code></pre>
<h4 id="authentication-and-authorization">Authentication and Authorization</h4>
<pre><code>https://odetocode.com/blogs/scott/archive/2017/02/06/anti-forgery-tokens-and-asp-net-core-apis.aspx

https://stackoverflow.com/questions/40351870/asp-net-core-custom-authentication-tying-request-to-user
</code></pre>
<h4 id="c">C#</h4>
<pre><code>Conversion of List of derived class to the base class.
    // https://stackoverflow.com/questions/1817300/convert-listderivedclass-to-listbaseclass
    dependentModels = new List&lt;DomainModel&gt;(candidateDependentModels).ConvertAll(m =&gt; (DomainModel)m);

Using reflection to call a generic method:
    // https://stackoverflow.com/questions/4101784/calling-a-generic-method-with-a-dynamic-type
    // https://stackoverflow.com/questions/16153047/net-invoke-async-method-and-await
    var method = typeof(ValidatedHandler&lt;TRequest, TResponse&gt;).GetMethod(nameof(ModelExistsAsync)).MakeGenericMethod(referenceType);
    var modelExists = await (Task&lt;bool&gt;)method.Invoke(this, new object[] {claimsPrincipal, (int) propertyValue});
</code></pre>


</body>
</html>